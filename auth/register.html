<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vema24 - Register</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="/css/styles.css" rel="stylesheet">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-storage-compat.js"></script>
    
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
    <!-- Loading screen -->
    <div id="loading-screen" class="fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50">
        <div class="text-center">
            <div class="inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600 mb-4"></div>
            <p class="text-gray-700">Checking authentication...</p>
        </div>
    </div>

    <div id="main-content" class="w-full max-w-md mx-auto">
        <div class="bg-white p-8 rounded-xl shadow-sm border border-gray-100">
            <!-- Logo and Header -->
            <div class="text-center mb-8">
                <img src="/assets/logo/Vema Black.png" alt="Vema Logo" class="h-14 mx-auto mb-5">
                <h1 class="text-3xl font-bold text-gray-900 mb-2">Create your account</h1>
                <p class="text-gray-500">Join Vema24 in just a few steps</p>
            </div>
            
            <!-- Progress Steps -->
            <div class="mb-10 px-2">
                <div class="relative">
                    <!-- Progress bar background -->
                    <div class="absolute top-1/2 left-0 right-0 h-1.5 bg-gray-100 -translate-y-1/2 z-0 rounded-full"></div>
                    <!-- Progress bar fill -->
                    <div id="progress-bar" class="absolute top-1/2 left-0 h-1.5 bg-blue-500 -translate-y-1/2 z-10 transition-all duration-300 rounded-full" style="width: 25%"></div>
                    
                    <!-- Step indicators -->
                    <div class="flex justify-between w-full relative z-20">
                        <div class="flex flex-col items-center">
                            <div class="w-9 h-9 rounded-full bg-blue-500 text-white flex items-center justify-center font-medium mb-1.5 border-4 border-white shadow-sm">1</div>
                            <span class="text-xs font-medium text-blue-500">Account</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="w-9 h-9 rounded-full bg-gray-100 text-gray-400 flex items-center justify-center font-medium mb-1.5 border-4 border-white shadow-sm">2</div>
                            <span class="text-xs font-medium text-gray-400">Profile</span>
                        </div>
                        <div id="address-step-indicator" class="flex flex-col items-center">
                            <div class="w-9 h-9 rounded-full bg-gray-100 text-gray-400 flex items-center justify-center font-medium mb-1.5 border-4 border-white shadow-sm">3</div>
                            <span class="text-xs font-medium text-gray-400">Address</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="w-9 h-9 rounded-full bg-gray-100 text-gray-400 flex items-center justify-center font-medium mb-1.5 border-4 border-white shadow-sm">4</div>
                            <span class="text-xs font-medium text-gray-400">Finish</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Messages -->
            <div id="error-message" class="hidden mb-4 p-3 bg-red-50 text-red-600 rounded-lg text-sm border border-red-100"></div>
            <div id="success-message" class="hidden mb-4 p-3 bg-green-50 text-green-600 rounded-lg text-sm border border-green-100"></div>
            
            <!-- Step 1: Account Information -->
            <form id="step1-form" class="step-form active space-y-5">
                <div>
                    <label for="email" class="block text-sm font-medium text-gray-700 mb-1.5">Email address</label>
                    <input type="email" id="email" name="email" required 
                           class="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all placeholder-gray-400"
                           placeholder="your@email.com">
                </div>
                
                <div>
                    <label for="password" class="block text-sm font-medium text-gray-700 mb-1.5">Password</label>
                    <input type="password" id="password" name="password" required 
                           class="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all placeholder-gray-400"
                           placeholder="••••••••">
                    <p class="text-xs text-gray-400 mt-1.5">Minimum 6 characters</p>
                </div>
                
                <div>
                    <label for="confirm-password" class="block text-sm font-medium text-gray-700 mb-1.5">Confirm password</label>
                    <input type="password" id="confirm-password" name="confirm-password" required 
                           class="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all placeholder-gray-400"
                           placeholder="••••••••">
                </div>
                
                <div class="pt-2">
                    <button type="button" onclick="nextStep(2)" 
                            class="w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-2.5 px-5 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2">
                        Continue
                    </button>
                </div>
            </form>
            
            <!-- Step 2: Profile Information -->
            <form id="step2-form" class="step-form hidden space-y-5">
                <div>
                    <label for="name" class="block text-sm font-medium text-gray-700 mb-1.5">Full name</label>
                    <input type="text" id="name" name="name" required 
                           class="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all placeholder-gray-400"
                           placeholder="John Doe">
                </div>
                
                <div>
                    <label for="phone" class="block text-sm font-medium text-gray-700 mb-1.5">Phone number</label>
                    <input type="tel" id="phone" name="phone" required 
                           class="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all placeholder-gray-400"
                           placeholder="+27 (123) 456-7890">
                </div>
                
                <div>
                    <label for="profileImage" class="block text-sm font-medium text-gray-700 mb-1.5">Profile photo (optional)</label>
                    <div class="flex items-center">
                        <label for="profileImage" class="cursor-pointer">
                            <div class="flex items-center space-x-3">
                                <div class="w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center overflow-hidden">
                                    <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                                              d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                    </svg>
                                </div>
                                <span class="text-sm text-blue-500 font-medium">Upload photo</span>
                            </div>
                            <input type="file" id="profileImage" name="profileImage" accept="image/*" class="hidden">
                        </label>
                        

                        <!-- 👇 file name will show here -->
                        <span id="file-name" class="ml-3 text-sm text-gray-500"></span>

                        <img id="profile-preview" class="hidden w-12 h-12 rounded-full object-cover" alt="Profile Preview">
                    </div>
                </div>
                
                
                <div class="flex justify-between pt-2">
                    <button type="button" onclick="prevStep(1)" 
                            class="bg-white hover:bg-gray-50 text-gray-700 font-medium py-2.5 px-5 rounded-lg border border-gray-200 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2">
                        Back
                    </button>
                    <button type="button" onclick="nextStep(3)" 
                            class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2.5 px-5 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2">
                        Continue
                    </button>
                </div>
            </form>
            
            <!-- Step 3: Address Information (only for South Africa) -->
            <form id="step3-form" class="step-form hidden space-y-5">
                <div>
                    <label for="street" class="block text-sm font-medium text-gray-700 mb-1.5">Street address</label>
                    <input type="text" id="street" name="street" required
                           class="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all placeholder-gray-400"
                           placeholder="123 Main St">
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label for="city" class="block text-sm font-medium text-gray-700 mb-1.5">City</label>
                        <input type="text" id="city" name="city" required
                               class="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all placeholder-gray-400"
                               placeholder="Johannesburg">
                    </div>
                    <div>
                        <label for="postalCode" class="block text-sm font-medium text-gray-700 mb-1.5">Postal code</label>
                        <input type="text" id="postalCode" name="postalCode" required
                               class="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all placeholder-gray-400"
                               placeholder="2000">
                    </div>
                </div>
                
                <div>
                    <label for="country" class="block text-sm font-medium text-gray-700 mb-1.5">Country</label>
                    <select id="country" name="country" required class="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all appearance-none bg-white">
                        <option value="ZA" selected>South Africa</option>
                    </select>
                </div>
                
                <div class="flex justify-between pt-2">
                    <button type="button" onclick="prevStep(2)" 
                            class="bg-white hover:bg-gray-50 text-gray-700 font-medium py-2.5 px-5 rounded-lg border border-gray-200 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2">
                        Back
                    </button>
                    <button type="button" onclick="nextStep(4)" 
                            class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2.5 px-5 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2">
                        Review
                    </button>
                </div>
            </form>
            
            <!-- Step 4: Review and Complete -->
            <div id="step4-form" class="step-form hidden space-y-5">
                <div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Review your information</h3>
                    
                    <div class="space-y-4">
                        <div class="bg-gray-50 p-4 rounded-lg border border-gray-100">
                            <h4 class="font-medium text-gray-700 mb-2 text-sm">Account Information</h4>
                            <p id="review-email" class="text-gray-600 text-sm"></p>
                        </div>
                        
                        <div class="bg-gray-50 p-4 rounded-lg border border-gray-100">
                            <h4 class="font-medium text-gray-700 mb-2 text-sm">Profile Information</h4>
                            <p id="review-name" class="text-gray-600 text-sm"></p>
                            <p id="review-phone" class="text-gray-600 text-sm mt-1"></p>
                        </div>
                        
                        <div class="bg-gray-50 p-4 rounded-lg border border-gray-100">
                            <h4 class="font-medium text-gray-700 mb-2 text-sm">Address Information</h4>
                            <p id="review-address" class="text-gray-600 text-sm"></p>
                        </div>
                    </div>
                </div>
                
                <div class="flex items-start pt-1">
                    <div class="flex items-center h-5">
                        <input type="checkbox" id="terms" name="terms" required 
                               class="h-4 w-4 text-blue-500 focus:ring-blue-400 border-gray-300 rounded">
                    </div>
                    <label for="terms" class="ml-3 block text-sm text-gray-600">
                        I agree to the <a href="#" onclick="openTermsModal()" class="text-blue-500 hover:text-blue-600 font-medium">Terms of Use</a> and <a href="#" onclick="openPrivacyModal()" class="text-blue-500 hover:text-blue-600 font-medium">Privacy Policy</a>
                    </label>
                </div>
                
                <div class="flex justify-between pt-2">
                    <button type="button" onclick="prevStep(3)" 
                            class="bg-white hover:bg-gray-50 text-gray-700 font-medium py-2.5 px-5 rounded-lg border border-gray-200 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2">
                        Back
                    </button>
                    <button type="button" id="complete-registration" 
                            class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2.5 px-5 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2 flex items-center justify-center min-w-[180px]">
                        <span id="complete-text">Complete Registration</span>
                        <span id="complete-spinner" class="hidden ml-2">
                            <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                        </span>
                    </button>
                </div>
            </div>
            
            <div class="mt-8 text-center pt-4 border-t border-gray-100">
                <p class="text-gray-500 text-sm">Already have an account? <a href="login.html" class="text-blue-500 hover:text-blue-600 font-medium">Sign in</a></p>
            </div>
        </div>
    </div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAEik5dGton3H4LyGDzYbNrw6GwutGNOqk",
            authDomain: "vema-7606a.firebaseapp.com",
            projectId: "vema-7606a",
            storageBucket: "vema-7606a.firebasestorage.app",
            messagingSenderId: "127492940070",
            appId: "1:127492940070:web:ddf247a2cb0723ddcbe1e7",
            measurementId: "G-2E6VC65Q3K"
        };
    
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
    
        // Auth state listener (⚠️ no auto-redirect here!)
        auth.onAuthStateChanged((user) => {
            if (!user) {
                document.getElementById('loading-screen').classList.add('hidden');
                document.getElementById('main-content').classList.remove('hidden');
            }
        });
    
        // Form data object
        const formData = {
            email: '',
            password: '',
            name: '',
            phone: '',
            profileImage: null,
            profileImageUrl: '',
            address: {
                street: '',
                city: '',
                postalCode: '',
                country: 'ZA'
            },
            joinDate: firebase.firestore.FieldValue.serverTimestamp()
        };
    
        // Profile image preview
        document.getElementById('profileImage').addEventListener('change', function () {
            const fileNameSpan = document.getElementById('file-name');
            const previewImg = document.getElementById('profile-preview');
    
            if (this.files.length > 0) {
                const file = this.files[0];
                fileNameSpan.textContent = file.name;
                formData.profileImage = file;
    
                const reader = new FileReader();
                reader.onload = function (e) {
                    previewImg.src = e.target.result;
                    previewImg.classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            } else {
                fileNameSpan.textContent = '';
                previewImg.classList.add('hidden');
                previewImg.src = '';
                formData.profileImage = null;
            }
        });
    
        // Navigation helpers
        function nextStep(next) {
            if (next === 2 && !validateStep1()) return;
            if (next === 3 && !validateStep2()) return;
            if (next === 4 && !validateStep3()) return;
    
            const progressPercentage = ((next - 1) / 3) * 100;
            document.getElementById('progress-bar').style.width = `${progressPercentage}%`;
            updateStepIndicators(next);
    
            document.querySelectorAll('.step-form').forEach(form => {
                form.classList.add('hidden');
                form.classList.remove('active');
            });
    
            const currentStep = document.getElementById(`step${next}-form`);
            currentStep.classList.remove('hidden');
            currentStep.classList.add('active');
    
            if (next === 4) populateReviewStep();
        }
    
        function prevStep(prev) {
            const progressPercentage = ((prev - 1) / 3) * 100;
            document.getElementById('progress-bar').style.width = `${progressPercentage}%`;
            updateStepIndicators(prev);
    
            document.querySelectorAll('.step-form').forEach(form => {
                form.classList.add('hidden');
                form.classList.remove('active');
            });
    
            document.getElementById(`step${prev}-form`).classList.remove('hidden');
            document.getElementById(`step${prev}-form`).classList.add('active');
        }
    
        function updateStepIndicators(currentStep) {
            const steps = document.querySelectorAll('.flex.flex-col.items-center.z-20');
            steps.forEach((step, index) => {
                const number = step.querySelector('div');
                const label = step.querySelector('span');
    
                if (index < currentStep - 1) {
                    number.className = 'w-9 h-9 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center font-medium mb-1.5 border-4 border-white shadow-sm';
                    label.className = 'text-xs font-medium text-blue-500';
                } else if (index === currentStep - 1) {
                    number.className = 'w-9 h-9 rounded-full bg-blue-500 text-white flex items-center justify-center font-medium mb-1.5 border-4 border-white shadow-sm';
                    label.className = 'text-xs font-medium text-blue-500';
                } else {
                    number.className = 'w-9 h-9 rounded-full bg-gray-100 text-gray-400 flex items-center justify-center font-medium mb-1.5 border-4 border-white shadow-sm';
                    label.className = 'text-xs font-medium text-gray-400';
                }
            });
        }
    
        // Validation
        function validateStep1() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
    
            if (!email.includes('@') || !email.includes('.')) {
                showError('Please enter a valid email address');
                return false;
            }
    
            if (password.length < 6) {
                showError('Password must be at least 6 characters');
                return false;
            }
    
            if (password !== confirmPassword) {
                showError('Passwords do not match');
                return false;
            }
    
            formData.email = email;
            formData.password = password;
            hideError();
            return true;
        }
    
        function validateStep2() {
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
    
            if (!name) {
                showError('Full name is required');
                return false;
            }
    
            if (!phone) {
                showError('Phone number is required');
                return false;
            }
    
            formData.name = name;
            formData.phone = phone;
            hideError();
            return true;
        }
    
        function validateStep3() {
            const street = document.getElementById('street').value;
            const city = document.getElementById('city').value;
            const postalCode = document.getElementById('postalCode').value;
    
            if (!street || !city || !postalCode) {
                showError('All address fields are required');
                return false;
            }
    
            formData.address.street = street;
            formData.address.city = city;
            formData.address.postalCode = postalCode;
            hideError();
            return true;
        }
    
        function populateReviewStep() {
            document.getElementById('review-email').textContent = formData.email;
            document.getElementById('review-name').textContent = `Name: ${formData.name}`;
            document.getElementById('review-phone').textContent = `Phone: ${formData.phone}`;
    
            const addressParts = [];
            if (formData.address.street) addressParts.push(formData.address.street);
            if (formData.address.city) addressParts.push(formData.address.city);
            if (formData.address.postalCode) addressParts.push(formData.address.postalCode);
            addressParts.push('South Africa');
    
            document.getElementById('review-address').textContent = addressParts.join(', ');
        }
    
        // Error handling
        function showError(message) {
            const errorDiv = document.getElementById('error-message');
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');
        }
    
        function hideError() {
            document.getElementById('error-message').classList.add('hidden');
        }
    
        // Complete registration
        document.getElementById('complete-registration').addEventListener('click', async function () {
            if (!document.getElementById('terms').checked) {
                showError('You must agree to the Terms of Use');
                return;
            }
    
            // Refresh latest form values
            formData.name = document.getElementById('name').value;
            formData.phone = document.getElementById('phone').value;
            formData.address.street = document.getElementById('street').value;
            formData.address.city = document.getElementById('city').value;
            formData.address.postalCode = document.getElementById('postalCode').value;
    
            const button = this;
            const buttonText = document.getElementById('complete-text');
            const spinner = document.getElementById('complete-spinner');
            const loadingScreen = document.getElementById('loading-screen');
    
            button.disabled = true;
            buttonText.classList.add('hidden');
            spinner.classList.remove('hidden');
            loadingScreen.classList.remove('hidden');
    
            try {
                loadingScreen.querySelector('p').textContent = 'Creating your account...';
                const userCredential = await auth.createUserWithEmailAndPassword(
                    formData.email,
                    formData.password
                );
                const user = userCredential.user;
    
                let profileImageUrl = '';
    
                if (formData.profileImage) {
                    try {
                        loadingScreen.querySelector('p').textContent = 'Uploading profile image...';
                        const storage = firebase.storage();
                        const storageRef = storage.ref();
                        const fileRef = storageRef.child(`users/${user.uid}/profile/${formData.profileImage.name}`);
                        await fileRef.put(formData.profileImage);
                        profileImageUrl = await fileRef.getDownloadURL();
                        console.log("Profile image uploaded:", profileImageUrl);
                    } catch (uploadError) {
                        console.error('Profile image upload failed:', uploadError);
                    }
                }
    
                const userData = {
                    uid: user.uid,
                    name: formData.name,
                    email: formData.email,
                    phone: formData.phone,
                    profileImageUrl: profileImageUrl || null,
                    address: formData.address,
                    joinDate: firebase.firestore.FieldValue.serverTimestamp(),
                    emailVerified: false,
                    lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
                };
    
                console.log("Saving user data to Firestore:", userData);
                loadingScreen.querySelector('p').textContent = 'Saving your information...';
                await db.collection('users').doc(user.uid).set(userData, { merge: true });
                console.log("Firestore save successful");
    
                loadingScreen.querySelector('p').textContent = 'Sending verification email...';
                await user.sendEmailVerification();
    
                loadingScreen.querySelector('p').textContent = 'Registration complete! Redirecting...';
                setTimeout(() => {
                    window.location.href = '/dashboard/index.html';
                }, 2000);
    
            } catch (error) {
                console.error('Registration error:', error);
                loadingScreen.classList.add('hidden');
                button.disabled = false;
                buttonText.classList.remove('hidden');
                spinner.classList.add('hidden');
    
                let errorMessage = 'Registration failed. Please try again.';
                if (error.code === 'auth/email-already-in-use') {
                    errorMessage = 'This email is already registered.';
                } else if (error.code === 'auth/weak-password') {
                    errorMessage = 'Password should be at least 6 characters.';
                } else if (error.code === 'permission-denied') {
                    errorMessage = 'Database write failed. Please contact support.';
                }
    
                showError(errorMessage);
    
                if (auth.currentUser) {
                    try {
                        await auth.currentUser.delete();
                        console.log("Rolled back user creation due to Firestore failure");
                    } catch (deleteError) {
                        console.error("Error deleting user after failed registration:", deleteError);
                    }
                }
            }
        });

        // Modal functions
        function openTermsModal() {
            const modal = document.getElementById('termsModal');
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
            loadTermsContent();
        }

        function closeTermsModal() {
            const modal = document.getElementById('termsModal');
            modal.classList.add('hidden');
            document.body.style.overflow = ''; // Restore scrolling
        }

        function openPrivacyModal() {
            const modal = document.getElementById('privacyModal');
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
            loadPrivacyContent();
        }

        function closePrivacyModal() {
            const modal = document.getElementById('privacyModal');
            modal.classList.add('hidden');
            document.body.style.overflow = ''; // Restore scrolling
        }

        // Load Terms of Use content
        async function loadTermsContent() {
            const contentDiv = document.getElementById('termsContent');
            try {
                const response = await fetch('../vema-termsandconds.html');
                const html = await response.text();
                
                // Extract content from the container div
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const container = doc.querySelector('.container');
                
                if (container) {
                    contentDiv.innerHTML = container.innerHTML;
                } else {
                    contentDiv.innerHTML = '<p class="text-red-600">Error loading Terms of Use content.</p>';
                }
            } catch (error) {
                console.error('Error loading Terms of Use:', error);
                contentDiv.innerHTML = '<p class="text-red-600">Error loading Terms of Use. Please try again later.</p>';
            }
        }

        // Load Privacy Policy content
        async function loadPrivacyContent() {
            const contentDiv = document.getElementById('privacyContent');
            try {
                const response = await fetch('../privacy-policy.html');
                const html = await response.text();
                
                // Extract content from the container div
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const container = doc.querySelector('.container');
                
                if (container) {
                    contentDiv.innerHTML = container.innerHTML;
                } else {
                    contentDiv.innerHTML = '<p class="text-red-600">Error loading Privacy Policy content.</p>';
                }
            } catch (error) {
                console.error('Error loading Privacy Policy:', error);
                contentDiv.innerHTML = '<p class="text-red-600">Error loading Privacy Policy. Please try again later.</p>';
            }
        }

        // Close modals when clicking outside
        document.addEventListener('click', function(event) {
            const termsModal = document.getElementById('termsModal');
            const privacyModal = document.getElementById('privacyModal');
            
            // Check if click is on the modal backdrop (not the modal content)
            if (event.target === termsModal && !termsModal.querySelector('.bg-white').contains(event.target)) {
                closeTermsModal();
            }
            if (event.target === privacyModal && !privacyModal.querySelector('.bg-white').contains(event.target)) {
                closePrivacyModal();
            }
        });

        // Close modals with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeTermsModal();
                closePrivacyModal();
            }
        });
    </script>
    
    <!-- Terms of Use Modal -->
    <div id="termsModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 overflow-y-auto">
        <div class="flex min-h-full items-center justify-center p-4">
            <div class="bg-white rounded-lg max-w-4xl w-full my-8 overflow-hidden shadow-xl">
                <div class="flex justify-between items-center p-4 md:p-6 border-b border-gray-200 sticky top-0 bg-white">
                    <h2 class="text-xl md:text-2xl font-bold text-gray-900">Terms of Use</h2>
                    <button onclick="closeTermsModal()" class="text-gray-400 hover:text-gray-600 text-2xl font-bold p-2">&times;</button>
                </div>
                <div class="p-4 md:p-6 max-h-[70vh] overflow-y-auto">
                    <div id="termsContent">
                        <p class="text-gray-600 mb-4">Loading Terms of Use...</p>
                    </div>
                </div>
                <div class="flex justify-end p-4 md:p-6 border-t border-gray-200 sticky bottom-0 bg-white">
                    <button onclick="closeTermsModal()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Privacy Policy Modal -->
    <div id="privacyModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 overflow-y-auto">
        <div class="flex min-h-full items-center justify-center p-4">
            <div class="bg-white rounded-lg max-w-4xl w-full my-8 overflow-hidden shadow-xl">
                <div class="flex justify-between items-center p-4 md:p-6 border-b border-gray-200 sticky top-0 bg-white">
                    <h2 class="text-xl md:text-2xl font-bold text-gray-900">Privacy Policy</h2>
                    <button onclick="closePrivacyModal()" class="text-gray-400 hover:text-gray-600 text-2xl font-bold p-2">&times;</button>
                </div>
                <div class="p-4 md:p-6 max-h-[70vh] overflow-y-auto">
                    <div id="privacyContent">
                        <p class="text-gray-600 mb-4">Loading Privacy Policy...</p>
                    </div>
                </div>
                <div class="flex justify-end p-4 md:p-6 border-t border-gray-200 sticky bottom-0 bg-white">
                    <button onclick="closePrivacyModal()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    
</body>
</html>